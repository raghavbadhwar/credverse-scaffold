(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[429],{5651:function(e,t,r){Promise.resolve().then(r.bind(r,8620))},8620:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return l}});var n=r(7437),i=r(2265),a=r(9501),s=r(467),o=r(7419),c=r(257);function l(){var e,t;let[r,l]=(0,i.useState)(!1),[d,u]=(0,i.useState)(null),[h,f]=(0,i.useState)(null),{register:v,handleSubmit:w}=(0,a.cI)(),y=async e=>{try{l(!0);let t=await (0,s.Tc)(e.hash);u(t)}catch(e){alert(e.message||"Verification failed")}finally{l(!1)}},m=async e=>{try{let t=e.target.value.trim();if(!t)return;let r=JSON.parse(t),n=c.env.NEXT_PUBLIC_DEMO_ISSUER_PRIVATE_KEY||"",i=new o.eG(n,"did:pkh:eip155:80002:0xYourIssuerAddress"),a=await i.verifyCredential(r);f(a)}catch(e){f(!1)}};return(0,n.jsxs)("div",{className:"max-w-3xl mx-auto py-10 px-4",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Verify Credential"}),(0,n.jsxs)("div",{className:"card mb-6",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-3",children:"Verify by On-Chain Hash"}),(0,n.jsxs)("form",{onSubmit:w(y),className:"flex gap-3",children:[(0,n.jsx)("input",{className:"input-field flex-1",placeholder:"0x… credential hash",...v("hash",{required:!0})}),(0,n.jsx)("button",{className:"btn-primary",type:"submit",disabled:r,children:r?"Verifying…":"Verify"})]}),d&&(0,n.jsxs)("div",{className:"mt-4 text-sm",children:[(0,n.jsxs)("div",{children:["Valid: ",(0,n.jsx)("span",{className:"font-mono",children:String(d.isValid)})]}),(0,n.jsxs)("div",{children:["Issuer: ",(0,n.jsx)("span",{className:"font-mono break-all",children:d.issuer})]}),(0,n.jsxs)("div",{children:["Revoked: ",(0,n.jsx)("span",{className:"font-mono",children:String(d.isRevoked)})]}),(0,n.jsxs)("div",{children:["Timestamp: ",(0,n.jsx)("span",{className:"font-mono",children:(null===(t=d.timestamp)||void 0===t?void 0:null===(e=t.toString)||void 0===e?void 0:e.call(t))||d.timestamp})]})]})]}),(0,n.jsxs)("div",{className:"card",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold mb-3",children:"Verify by JSON"}),(0,n.jsx)("textarea",{className:"input-field h-48",placeholder:"Paste credential JSON here",onChange:m}),null!==h&&(0,n.jsxs)("div",{className:"mt-2 text-sm",children:["Signature valid: ",(0,n.jsx)("span",{className:"font-mono",children:String(h)})]})]})]})}},467:function(e,t,r){"use strict";r.d(t,{Tc:function(){return u},g6:function(){return d}});var n=r(4776),i=r(5810);let a=["function anchorCredential(bytes32 credentialHash, string credentialId, string ipfsHash, string arweaveId) external","function verifyCredential(bytes32 credentialHash) external view returns (bool isValid, address issuer, uint256 timestamp, bool isRevoked)","function getCredential(bytes32 credentialHash) external view returns (tuple(bytes32 hash, address issuer, uint256 timestamp, bool isRevoked, string revocationReason, string credentialId, string ipfsHash, string arweaveId))","function isIssuer(address issuer) external view returns (bool)"],s="0x8ce3f05fE9cE9D63dA4b9E80EE46C4df07C12BcE";function o(){if(!window.ethereum)throw Error("No injected wallet found. Please install MetaMask.");return new n.Q(window.ethereum)}async function c(){let e=o();return await e.send("eth_requestAccounts",[]),await e.getSigner()}async function l(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!s)throw Error("Missing NEXT_PUBLIC_CREDENTIAL_REGISTRY_ADDRESS");if(e){let e=o();return new i.CH(s,a,e)}let t=await c();return new i.CH(s,a,t)}async function d(e,t,r,n){let i=await l(!1),a=await i.anchorCredential(e,t,r,n);return await a.wait()}async function u(e){let t=await l(!0),r=await t.verifyCredential(e);return{isValid:r[0],issuer:r[1],timestamp:r[2],isRevoked:r[3]}}},7419:function(e,t,r){"use strict";r.d(t,{Ab:function(){return v},eG:function(){return d},h6:function(){return u},lw:function(){return w}});var n=r(2211),i=r(8393),a=r(4355),s=r(135),o=r(9478),c=r(257),l=r(2957).lW;class d{async createCredential(e,t,r){return{"@context":["https://www.w3.org/2018/credentials/v1","https://credverse.in/contexts/v1"],id:this.generateCredentialId(),type:["VerifiableCredential","CredVerseCredential",r],issuer:this.issuerDID,issuanceDate:new Date().toISOString(),credentialSubject:e,metadata:{...t,blockchainHash:"",issuerDID:this.issuerDID,templateId:r}}}async signCredential(e){try{let t=new n.w(this.issuerPrivateKey),r=this.hashCredential(e),i=await t.signMessage(r),a={type:"EthereumEip712Signature2021",created:new Date().toISOString(),verificationMethod:"".concat(this.issuerDID,"#keys-1"),proofPurpose:"assertionMethod",proofValue:i};return{...e,proof:a}}catch(e){throw Error("Failed to sign credential: ".concat(e))}}async verifyCredential(e){try{if(!e.proof)return!1;let{proof:t,...r}=e,n=this.hashCredential(r),s=i.n(n,t.proofValue),o=e.issuer;if("string"==typeof o&&o.startsWith("did:pkh:")){let e=o.split(":"),t=e[e.length-1];return s.toLowerCase()===t.toLowerCase()}let c=await this.resolveDIDPublicKey(o),l=a.d(c);return s.toLowerCase()===l.toLowerCase()}catch(e){return console.error("Credential verification failed:",e),!1}}async anchorToBlockchain(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{let t=this.hashCredential(e);return s.w(o.Y0(t+Date.now()))}catch(e){throw Error("Failed to anchor credential to blockchain: ".concat(e))}}async storeToIPFS(e){try{let t;let n=c.env.IPFS_ENDPOINT||"https://ipfs.infura.io:5001/api/v0",i=c.env.IPFS_PROJECT_ID,a=c.env.IPFS_PROJECT_SECRET,{create:s}=await Promise.all([r.e(283),r.e(897)]).then(r.bind(r,6283));if(i&&a){let e="".concat(i,":").concat(a);"undefined"!=typeof btoa?t="Basic "+btoa(e):void 0!==l&&(t="Basic "+l.from(e).toString("base64"))}let o=s({url:n,headers:t?{Authorization:t}:void 0}),d={...e,storedAt:new Date().toISOString(),storageProvider:"ipfs"},{cid:u}=await o.add(JSON.stringify(d));return u.toString()}catch(t){return s.w(o.Y0(JSON.stringify(e)))}}async storeToArweave(e){try{let t=c.env.ARWEAVE_HOST||"arweave.net",n=Number(c.env.ARWEAVE_PORT||443),i=c.env.ARWEAVE_PROTOCOL||"https",a=c.env.ARWEAVE_JWK?JSON.parse(c.env.ARWEAVE_JWK):null;if(!a)return"";let s=await r.e(93).then(r.t.bind(r,7093,23)),o=(s.default||s).init({host:t,port:n,protocol:i}),l={...e,storedAt:new Date().toISOString(),storageProvider:"arweave"},d=await o.createTransaction({data:JSON.stringify(l)},a);d.addTag("Content-Type","application/json"),await o.transactions.sign(d,a);let u=await o.transactions.post(d);if(200===u.status||202===u.status)return d.id;return""}catch(e){return""}}async revokeCredential(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];try{return!0}catch(e){throw Error("Failed to revoke credential: ".concat(e))}}async isCredentialRevoked(e){try{return!1}catch(e){return console.error("Failed to check credential revocation status:",e),!1}}generateCredentialId(){let e=Date.now(),t=Math.random().toString(36).substring(2);return"urn:credverse:credential:".concat(e,":").concat(t)}hashCredential(e){let t=h(e);return s.w(o.Y0(JSON.stringify(t)))}normalizeCredential(e){return h(e)}sortObjectKeys(e){return f(e)}async resolveDIDPublicKey(e){try{throw Error("Unsupported DID method: ".concat(e))}catch(e){throw Error("Failed to resolve DID: ".concat(e))}}constructor(e,t){this.issuerPrivateKey=e,this.issuerDID=t}}function u(e){let t=h(e);return s.w(o.Y0(JSON.stringify(t)))}function h(e){let{proof:t,...r}=e||{};return f(r)}function f(e){if(null===e||"object"!=typeof e)return e;if(Array.isArray(e))return e.map(e=>f(e));let t={};return Object.keys(e).sort().forEach(r=>{t[r]=f(e[r])}),t}function v(e){return"".concat("http://localhost:3000","/verify/").concat(e.id)}function w(e){return JSON.stringify(e,null,2)}}},function(e){e.O(0,[303,470,971,117,744],function(){return e(e.s=5651)}),_N_E=e.O()}]);